
[Consul官方网站](https://www.consul.io/)|[使用Consul为例来搭建和使用注册中心](https://yasinshaw.com/articles/43)|
---|---|

[Spring Cloud Consul上篇](https://weread.qq.com/web/reader/71d32370716443e271df020kd1f32d7024fd1fe173d0651)|[Spring Cloud Consul下篇](https://weread.qq.com/web/reader/71d32370716443e271df020kfe932230253fe9fc289c8a3)|
---|---|

# 在线书籍

* [2 微服务分布式架构基础与实战： 基于Spring Boot + Spring Cloud---2020 组件包括 Consul + Feign + Hystrix + Ribbon + 缓存 + 消息通信 + 微服务异步线程池 + 微服务数据持久化 +  微服务事务 + 微服务的缓存和分布式消息通信 + 微服务的任务调度和分布式任务调度 + 微服务的文件上传和分布式文件管理 + 展部署](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178)

* [5 Spring Cloud微服务架构实战---2020 本书以电商案例讲解微服务开发环境塔建，微服务治理，数据架构设计，展示层架构设计，分布式文件系统设计，高并发订单架构设计，移动端商城架构设计，管理后台架构设计，很好的微服务架构入门书, 是 “Spring Cloud与Docker高并发微服务架构设计实施” 的改编版, jenkis + FastDFS + MySQL分库分区 读写分离 主从同步 主主同步 + Docker部署 + SSO设计 +  MongoDB + Mybatis + RESTful API + Spring data JPA + Zipkin + ELK + Consul + ](https://weread.qq.com/web/reader/ca932ea071d7c798ca9a714)
 
* [8 （先看） 重新定义Spring Cloud实战---2018 Spring Cloud中国社区倾力打造，多位行业专家推荐，作者来自原阿里、蚂蚁金服、京东金融等互联网企业, 一本实践与理论并重、广度与深度兼顾的Spring Cloud生产实践开发指南, 有3大特色: 足够广,有深度,重实践](https://weread.qq.com/web/reader/71d32370716443e271df020kc81322c012c81e728d9d180)

* [10  （先看）  深入理解Spring Cloud与微服务构建 （第2版）---包括Spring Boot + Eureka、Consul, Ribbon + RestTemplate , Feign、Hystrix、Zuul、Gateway、Consul、Config、Sleuth、Admint等组件,使用JWT, Spring Cloud OAuth2来保护微服务系统, 还有一个综合案例](https://weread.qq.com/web/reader/1223205071ccfab912296c2)


# 目录
* [Consul的概念](#Consul的概念)
  * [微服务注册中心比较(ZooKeeper/Eureka/Consul/Nacos)](https://www.cnblogs.com/davidgu/p/14526467.html)
  * [Eureka与Consul的区别](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k6f4322302126f4922f45dec)
  * [Consul注册中心的默认端口号](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k98f3284021498f137082c2e)
* [Consul的安装](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k6f4322302126f4922f45dec)
* [用Consul创建注册中心](https://weread.qq.com/web/reader/ca932ea071d7c798ca9a714k67c32d7022f67c6a1e7ce82)
  * 1. 依赖引用
  * 2. 连接设置
  * [3. 统一配置管理](https://weread.qq.com/web/reader/ca932ea071d7c798ca9a714k67c32d7022f67c6a1e7ce82)
  * 4. 注册激活 
* [Consul启动](https://weread.qq.com/web/reader/71d32370716443e271df020kf03328d0250f033ab37c722)
* [Consul UI页面展示](https://weread.qq.com/web/reader/71d32370716443e271df020kf03328d0250f033ab37c722)
* [Consul的常用命令](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k1f032c402131f0e3dad99f3)
* [Consul实用接口](https://weread.qq.com/web/reader/71d32370716443e271df020kf03328d0250f033ab37c722)
  * 运维人员喜欢的命令行接口
  * 开发人员喜欢的HTTP接口 
* [Spring Cloud Consul的模块介绍](https://weread.qq.com/web/reader/71d32370716443e271df020k68d3221025468d30a95982e)
  * Spring-cloud-consul-binder：对Consul的事件功能封装
  * [Spring-cloud-consul-config：对Consul的配置功能封装](https://weread.qq.com/web/reader/71d32370716443e271df020k68d3221025468d30a95982e)
  * Spring-cloud-consul-core：基础配置和健康检查模块
  * [Spring-cloud-consul-discovery：对Consul服务治理功能封装](https://weread.qq.com/web/reader/71d32370716443e271df020k68d3221025468d30a95982e)
    * [Spring-cloud-consul-discovery服务注册](https://weread.qq.com/web/reader/71d32370716443e271df020k68d3221025468d30a95982e)
    * [Spring-cloud-consul-discovery服务发现](https://weread.qq.com/web/reader/71d32370716443e271df020k68d3221025468d30a95982e) 

* 案例
  * [搭建Consul集群案例](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k98f3284021498f137082c2e)  
  * [通过代码获取Consul中的服务信息](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178k3c5327902153c59dc0488e1)
  * [Spring Cloud操作Consul的K/V存储](https://weread.qq.com/web/reader/f6732e8071dbddd6f674178kb6d32b90216b6d767d2f0dc)
  * [通过Spring Boot，Spring Cloud Gateway构建基于Consul集群的微服务案例演示 ](https://www.jdon.com/53374)
  * [Spring Cloud Consul入门案例](https://weread.qq.com/web/reader/71d32370716443e271df020k43e327b025143ec517d680b)


# Consul的概念

Consul是一个服务网格（service mesh）解决方案，是一个分布式高可用的服务系统发现与配置工具、中间件，由HashiCorp公司研发。Consul以Go语言编写，用HTTP方式对外提供服务，支持多数据中心，支持K/V键值对存储，可以构建完整的服务网格, **Consul注册中心是Linux系统中可直接运行的二进制文件**

**Consul主要功能如下**。

（1）服务发现：服务可以通过HTTP方式找到其他依赖Consul的服务

（2）健康检查：检查服务是否正在正常响应

（3）K/V存储：提供了简易的HTTP接口满足用户的动态配置

（4）安全业务通信：生成和分发服务的TLS证书，以建立相互的TLS连接，允许服务相互通信

（5）多数据中心：支持多数据中心。不用构建额外的抽象层就能扩展到多个区域

**Consul主要特点如下。**

（1）Consul提供了健康检查能力、K/V存储和多数据中心意识。Consul要求每个数据中心都有一组服务器，以及每个客户端上的一个代理，类似Sideecar。Consul代理允许大多数应用程序在不知情的情况下，通过配置文件执行服务注册，并通过DNS或负载均衡进行发现。

（2）Consul提供了一致性保证，服务器使用RAFT协议，Consul提供的健康检查能力包括TCP、HTTP、Nagios/Sensu（网络监视工具）。

（3）Consul的客户端节点依靠Gossip Based节点采样技术，即Gossip协议，通过采样技术进行健康检查。Consul主动发现并发送请求给当前的Consul Leader，即非集中式心跳，而集中性心跳将会成为可伸缩架构的障碍。

（4）Consul提供了支持面向服务体系结构所需的工具包，包括服务发现、健康检查、服务锁定、K/V、多数据联合、事件系统和ACL。Consul试图将应用程序更改的内容降到最少，以避免通过SDK与本机进行集成。

（5）Consul使用Raft算法保证一致性，比复杂的Paxos算法更直接。Zookeeper采用Paxos，而Etcd采用Raft。

# 参考
* [Spring Cloud Finchley版中Consul多实例注册的问题处理](http://blog.didispace.com/Spring-Cloud-Finchley-Consul-InstanceId/)
* [基于Consul的分布式锁实现](http://blog.didispace.com/spring-cloud-consul-lock-and-semphore/)
* [基于Consul的分布式信号量实现](http://blog.didispace.com/spring-cloud-consul-lock-and-semphore-2/)
* [Consul注销实例时候的问题](http://blog.didispace.com/consul-deregister/)
* [使用Consul做服务发现的若干姿势](http://blog.didispace.com/consul-service-discovery-exp/)
* [Spring Cloud构建微服务架构：服务注册与发现（Eureka、Consul）](http://blog.didispace.com/spring-cloud-starter-dalston-1/)
* [Consul注销实例时候的问题](http://blog.didispace.com/consul-deregister/)
